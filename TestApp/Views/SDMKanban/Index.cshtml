
@{
    ViewBag.Title = "Index";
    Layout = null;
}


<style>
    .layBakColor {
        background-color:#18345B
    }
    .BlockIn {
        background-color: #18345B
    }

    ul.line {
        width: 500px;
        height: 30px;
        background-color: #18345B;
        overflow: hidden;
        /*margin-bottom: 20px;*/
        /*border: 2px solid #363636;*/
        /*margin-top: 100px;*/
        /*margin-left: 100px;*/
    }

        ul.line li {
            height: 30px;
            text-indent: 15px;
            font-size: 15px;
            line-height: 30px;
            list-style: none;
            color:white;
        }

    .DivBorder {
        /*border: solid thin #191970*/
    }

    .Logo {
        font-size: 25px;
        color: white;
        font-weight: bold;
        font-family: sans-serif;
        text-align:center;
        
    }
    .LogoTime {
        color: white;
        text-align:center;
        /*position: absolute;
        right: 0;
        bottom: 0;*/
    }

    .full {
        position: fixed;
        align-content: center;
        /*top: 10px;*/
        /*left: 10px;*/
        /*
              原来基础的百分百
            */
        width: 100%;
        height: 100%;
        overflow: auto;
    }



</style>

<script src="~/Scripts/JQGrid/js/jquery-1.11.0.min.js"></script>
<link href="~/Scripts/layui/css/layui.css" rel="stylesheet" />
<script src="~/Scripts/layui/layui.js"></script>
<script src="~/Scripts/echarts/echarts.js"></script>

<link href="~/Content/NumScoller/css/globle.css" rel="stylesheet" />
<script src="~/Content/NumScoller/js/num.js"></script>
@*<link href="~/Content/TxtScoller/style2.css" rel="stylesheet" />*@
<script src="~/Content/TxtScoller/myslideup.js"></script>




<div id="allscreen" style="height:100%">
<div id="main1" class="layui-container layBakColor" style="width:100%;">
    <div class="layui-row">
        <div class="layui-row">
            <div class="layui-col-lg12 Logo">上海圣德曼铸造海安有限公司</div>
        </div>
        <div class="layui-row">
            <div id="CurrentTime" class="layui-col-lg12 LogoTime">

            </div>
        </div>

    </div>
    <br>
</div>

<div id="main2" class="layui-container layBakColor" style="width:100%;">
    <div class="layui-row layui-col-space20">
        <div class="layui-col-lg4 layui-col-space20">
            <div class="layui-row">
                <div class="layui-col-lg12 BlockIn DivBorder">
                    @*各产线当天停机时长*@
                    <div id="TodayStopTime" style="width:auto;height:275px"></div>
                </div>
            </div>
            <div class="layui-row">
                <div class="layui-col-lg12 BlockIn DivBorder">
                    @*环境猫数据*@
                    <div id="HJMData" style="width:auto;height:235px"></div>
                </div>
            </div>
            <div class="layui-row">
                <div class="layui-carousel BlockIn" id="test2">
                    <div carousel-item class="BlockIn DivBorder">
                        <div id="SPONEPASS" class="BlockIn" style="width: 600px;height:235px;background-color:#18345B"></div>
                        <div id="DISAONEPASS" class="BlockIn" style="width: 600px;height:235px;background-color:#18345B"></div>
                        <div id="KXONEPASS" class="BlockIn" style="width: 600px;height:235px;background-color:#18345B"></div>
                    </div>
                </div>
                @*<div class="layui-col-lg4 BlockIn">

                <div id="SPONEPASS" style="width:auto;height:275px"></div>
            </div>
            <div class="layui-col-lg4 BlockIn">

                <div id="DISAONEPASS" style="width:auto;height:275px"></div>

            </div>
            <div class="layui-col-lg4 BlockIn">

                <div id="KXONEPASS" style="width:auto;height:275px"></div>
            </div>*@
            </div>

        </div>
        <div class="layui-col-lg4 layui-col-space20 ">

            <div id="h1" class="layui-row ">
                <div class="layui-col-lg12">
                    <div class="layui-row">
                        <div class="layui-col-lg12"><font color="white" size="4" face="sans-serif"><b>本年累计生产箱数</b></font></div>
                    </div>
                    <br><br><br><br>
                    <div class="layui-row">
                        <div class="layui-col-lg12"><div id="dataNums3"> </div></div>
                    </div>

                </div>

            </div>
            <div id="h2" class="layui-row">
                <div class="layui-col-lg12">
                    <ul class="line"></ul>
                </div>
            </div>
            <div class="layui-row">
                <div class="layui-col-lg12 BlockIn DivBorder">
                    <div id="DayData" style="width: auto;height:235px"></div>
                </div>
            </div>

            <div class="layui-row">
                <div class="layui-col-lg12 BlockIn DivBorder">
                    <div id="PourRate" style="width: auto;height:235px"></div>
                </div>
            </div>

        </div>
        <div class="layui-col-lg4 layui-col-space10">
            <div class="layui-row ">
                <div class="layui-col-lg4 BlockIn DivBorder">
                    <div id="CZX" style="width: auto;height:275px"></div>
                </div>
                <div class="layui-col-lg4 BlockIn DivBorder">
                    <div id="SPX" style="width: auto;height:275px"></div>
                </div>
                <div class="layui-col-lg4 BlockIn DivBorder">
                    <div id="KXX" style="width: auto;height:275px"></div>
                </div>
            </div>
            @*<div class="layui-row">
                <div class="layui-col-lg4 BlockIn">
                    <div id="DISAQ1" style="width: auto;height:205px"></div>
                </div>
                <div class="layui-col-lg4 BlockIn">
                    <div id="KWQ1" style="width: auto;height:205px"></div>
                </div>
                <div class="layui-col-lg4 BlockIn">
                    <div id="KXQ1" style="width: auto;height:205px"></div>
                </div>
            </div>*@
            <div class="layui-row">
                <div class="layui-col-lg12 BlockIn DivBorder">
                    <div id="QuaifiedRate" style="width: auto;height:235px"></div>
                </div>
            </div>
            <br>
            <div class="layui-row">
                <div class="layui-carousel BlockIn" id="test1">
                    <div carousel-item class="BlockIn DivBorder">
                        <div id="Equip1" class="BlockIn" style="width: 600px;height:235px;background-color:#18345B"></div>
                        <div id="Equip2" class="BlockIn" style="width: 600px;height:235px;background-color:#18345B"></div>
                        <div id="Equip3" class="BlockIn" style="width: 600px;height:235px;background-color:#18345B"></div>
                    </div>
                </div>
                @*<div class="layui-col-lg4 BlockIn">
            <div id="Equip1" style="width: auto;height:218px"></div>
        </div>
        <div class="layui-col-lg4 BlockIn">
            <div id="Equip2" style="width: auto;height:218px"></div>
        </div>
        <div class="layui-col-lg4 BlockIn">
            <div id="Equip3" style="width: auto;height:218px"></div>
        </div>*@
            </div>
        </div>
    </div>
</div>

</div>
<script>
    //增加定时的功能，每10分钟更新一次数据
    setInterval(function (
    ) {
        var PageSize = GetPageSize();
        var EHeight = PageSize[3] / 3 - 20;
        var EWidth = PageSize[2] / 3 - 40;
        //alert(EHeight);
        //$("#TodayStopTime").css()
        $("#TodayStopTime").css("height", EHeight);
        $("#HJMData").css("height", EHeight);
        $("#SPONEPASS").css("height", EHeight);
        $("#SPONEPASS").css("width", EWidth);
        $("#DISAONEPASS").css("height", EHeight);
        $("#DISAONEPASS").css("width", EWidth);
        $("#KXONEPASS").css("height", EHeight);
        $("#KXONEPASS").css("width", EWidth);
        $("#DayData").css("height", EHeight);
        $("#PourRate").css("height", EHeight);
        $("#CZX").css("height", EHeight);
        $("#SPX").css("height", EHeight);
        $("#KXX").css("height", EHeight);
        $("#QuaifiedRate").css("height", EHeight);
        $("#Equip1").css("height", EHeight);
        $("#Equip1").css("width", EWidth);
        $("#Equip2").css("height", EHeight);
        $("#Equip2").css("width", EWidth);
        $("#Equip3").css("height", EHeight);
        $("#Equip3").css("width", EWidth);

        $("#h1").css("height", EHeight / 2.0);
        $("#h2").css("height", EHeight / 2.0 - 20);
        //Equip3

        ServerCurrentTime();
        SetTodayStopTime();
        SetYearData();
        SetDayData();
        setOEEData("垂直线", "底注式浇注机", "CZX");
        setOEEData("水平线", "水平浇注机", "SPX");
        setOEEData("壳型线", "壳型线扇形浇注机", "KXX");
        SetPourRate();
        SetScollerData();
        //setDefectRateData("DISA", "DISAQ1");
        //setDefectRateData("KW", "KWQ1");
        //setDefectRateData("KX", "KXQ1");
        setQualifiedRate();
        SetEquipMainData("SBXJGD", "Equip1");
        SetEquipMainData("SBBYGD", "Equip2");
        SetEquipMainData("SBDJGD", "Equip3");
        SetOnePassData();
        GetHJMList();
        SetHJMData();

        layui.use('carousel', function () {
            var carousel = layui.carousel;
            //建造实例
            carousel.render({
                elem: '#test1'
                , width: '100%' //设置容器宽度
                , arrow: 'always' //始终显示箭头
                //,anim: 'updown' //切换动画方式
                , interval: '10000' //间隔时间10秒
            });
        });

        layui.use('carousel', function () {
            var carousel = layui.carousel;
            //建造实例
            carousel.render({
                elem: '#test2'
                , width: '100%' //设置容器宽度
                , arrow: 'always' //始终显示箭头
                //,anim: 'updown' //切换动画方式
                , interval: '10000' //间隔时间10秒
            });
        });
    }, 1000*60*10);

    $(function () {
        $("#allscreen").click(function () {
            $("#allscreen").fullScreen();

        })
    });
    function GetPageSize() {
        var xScroll, yScroll;
        if (window.innerHeight && window.scrollMaxY) {
            xScroll = document.body.scrollWidth;
            yScroll = window.innerHeight + window.scrollMaxY;
        } else if (document.body.scrollHeight > document.body.offsetHeight) {
            xScroll = document.body.scrollWidth;
            yScroll = document.body.scrollHeight;
        } else {
            xScroll = document.body.offsetWidth;
            yScroll = document.body.offsetHeight;
        }
        var windowWidth, windowHeight;
        if (self.innerHeight) {
            windowWidth = self.innerWidth;
            windowHeight = self.innerHeight;
        } else if (document.documentElement && document.documentElement.clientHeight) {
            windowWidth = document.documentElement.clientWidth;
            windowHeight = document.documentElement.clientHeight;
        } else if (document.body) {
            windowWidth = document.body.clientWidth;
            windowHeight = document.body.clientHeight;
        }
        if (yScroll < windowHeight) {
            pageHeight = windowHeight;
        } else {
            pageHeight = yScroll;
        }
        if (xScroll < windowWidth) {
            pageWidth = windowWidth;
        } else {
            pageWidth = xScroll;
        }
        arrayPageSize = new Array(pageWidth, pageHeight, windowWidth, windowHeight)
        return arrayPageSize;
    }
    
    $(document).ready(function () {
        var PageSize = GetPageSize();
        var EHeight = PageSize[3] / 3 - 20;
        var EWidth = PageSize[2] / 3-40;
        //alert(EHeight);
        //$("#TodayStopTime").css()
        $("#TodayStopTime").css("height", EHeight);
        $("#HJMData").css("height", EHeight);
        $("#SPONEPASS").css("height", EHeight);
        $("#SPONEPASS").css("width", EWidth);
        $("#DISAONEPASS").css("height", EHeight);
        $("#DISAONEPASS").css("width", EWidth);
        $("#KXONEPASS").css("height", EHeight);
        $("#KXONEPASS").css("width", EWidth);
        $("#DayData").css("height", EHeight);
        $("#PourRate").css("height", EHeight);
        $("#CZX").css("height", EHeight);
        $("#SPX").css("height", EHeight);
        $("#KXX").css("height", EHeight);
        $("#QuaifiedRate").css("height", EHeight);
        $("#Equip1").css("height", EHeight);
        $("#Equip1").css("width", EWidth);
        $("#Equip2").css("height", EHeight);
        $("#Equip2").css("width", EWidth);
        $("#Equip3").css("height", EHeight);
        $("#Equip3").css("width", EWidth);

        $("#h1").css("height", EHeight/2.0);
        $("#h2").css("height", EHeight/2.0-20);
        //Equip3

        ServerCurrentTime();
        SetTodayStopTime();
        SetYearData();
        SetDayData();
        setOEEData("垂直线", "底注式浇注机", "CZX");
        setOEEData("水平线", "水平浇注机", "SPX");
        setOEEData("壳型线", "壳型线扇形浇注机", "KXX");
        SetPourRate();
        SetScollerData();
        //setDefectRateData("DISA", "DISAQ1");
        //setDefectRateData("KW", "KWQ1");
        //setDefectRateData("KX", "KXQ1");
        setQualifiedRate();
        SetEquipMainData("SBXJGD", "Equip1");
        SetEquipMainData("SBBYGD", "Equip2");
        SetEquipMainData("SBDJGD", "Equip3");
        SetOnePassData();
        GetHJMList();
        SetHJMData();

        layui.use('carousel', function () {
            var carousel = layui.carousel;
            //建造实例
            carousel.render({
                elem: '#test1'
                , width: '100%' //设置容器宽度
                , arrow: 'always' //始终显示箭头
                //,anim: 'updown' //切换动画方式
                , interval:'10000' //间隔时间10秒
            });
        });

        layui.use('carousel', function () {
            var carousel = layui.carousel;
            //建造实例
            carousel.render({
                elem: '#test2'
                , width: '100%' //设置容器宽度
                , arrow: 'always' //始终显示箭头
                //,anim: 'updown' //切换动画方式
                , interval: '10000' //间隔时间10秒
            });
        });
        

    });

    function SetYearData()
    {
        
        $.ajax({
            type: "post",
            url: "/SDMKanban/GetYearData",
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                var dataA = new Array();
                dataA = data.split("|");

                $("#dataNums3").rollNumDaq({
                    deVal: dataA[0],
                    className: 'dataNums'
                });
                //$("#dataNums2").rollNumDaq({
                //    deVal: dataA[1],
                //    className: 'dataNums2'
                //});
            }

        });
    }

    function SetScollerData() {
        $(".line").html("");
        $.ajax({
            type: "post",
            url: "/SDMKanban/GetScollerTxt",
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                //console.log(data);
                $(".line").append(data);
            }

        });
        

        $(".line").slideUp();

        //var list = document.getElementsByTagName("li");
        //for (var i = 0; i < list.length; i++) {
        //    list[i].index = i;
        //    list[i].onclick = function () {
        //        console.log(this.index);
        //    }
        //}
    }

    function setOEEData(pdline, sebname, divname) {
        var OEEValue;
        $.ajax({
            type: "post",
            url: "/SDMKanban/getEquipmentOEEResult",
            data: {
                pdline: pdline,
                sebname: sebname
            },
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                //console.log(data);
                OEEValue = data;
            }

        });
        var TempTitle = "";
        if (pdline == "垂直线") {
            TempTitle = "设备OEE";
        }
        option = {
            title: {
                text: TempTitle,
                x: "left",
                textStyle: {
                    color: '#ffffff'
                },
                //top: 10,

            },
            tooltip: {
                formatter: "{a}<br/>{b}:{c}"
            },
            
            grid: {
                //left: '3%',   //距离左边的距离
                //right: '6%', //距离右边的距离
                //bottom: '8%',//距离下边的距离
                y: '20%'
            },

            series: [{
                name: pdline,
                type: 'gauge',
                radius: '90%',
                min: 0,
                max: 100,
                axisLine: {
                    show: true,
                    lineStyle: {
                        width: 16,
                        shadowBlur: 0,
                        color: [[0.2, '#E43F3D'], [0.4, '#E98E2C'], [0.6, '#DDBD4D'], [0.8, '#7CBB55'], [1, '#87CEFA']]
                    }
                },


                axisTick: {
                    show: true,
                    splitNumber: 1
                },
                splitLine: {
                    show: false,
                },
                axisLabel: {
                    distance: -10,
                    textStyle: {
                        fontSize: 10,
                        fontWeight: ""
                    }
                },
                pointer: {
                    show: true,
                },
                detail: {
                    formatter: pdline+':'+'{value}',
                    offsetCenter: [0, 65],
                    textStyle: {
                        fontSize: 20,
                        color:'#fff'
                    }
                },
                data: [{
                    //name: pdline+"OEE",
                    value: OEEValue
                }]
            }]
        }

        var myChart = echarts.init(document.getElementById(divname));
        myChart.setOption(option);
    }

    function setDefectRateData(pdline, divname) {
        var SeriesData = new Array();
        var legendData = new Array();
        $.ajax({
            type: "post",
            url: "/SDMKanban/getDefectRate",
            data: {
                pdline: pdline
            },
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                Jdata = JSON.parse(data);
                //console.log(Jdata);
                for (var i = 0; i < Jdata.length; i++) {
                    
                    var a = new Object();
                    a.value = Jdata[i].qty;
                    a.name = Jdata[i].spc_name;
                    SeriesData.push(a);
                    legendData.push(Jdata[i].spc_name);

                }
                
            }

        });
        
        var Title = "";
        if (pdline == "KW") { Title = "水平线不良率占比"; }
        else if (pdline == "KX") { Title = "壳形线不良率占比"; }
        else if (pdline == "DISA") { Title = "垂直线不良率占比"; }
        
        option = {
            title: {
                text: Title,
                y: 'bottom',
                x: 'center',
                textStyle: {
                    color: '#ffffff'
                },
            },
            tooltip: {
                trigger: 'item',
                formatter: "{b}: <br/>{c} ({d}%)"
            },
            //legend: {
            //    orient: 'vertical',
            //    x: 'left',
            //    data: legendData
            //},
            series: [
                {
                    name: '缺陷数量',
                    type: 'pie',
                    radius: ['25%', '30%'],
                    avoidLabelOverlap: false,
                    label: {
                        normal: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            show: true,
                            textStyle: {
                                fontSize: '15',
                                fontWeight: 'bold'
                            }
                        }
                    },
                    labelLine: {
                        normal: {
                            show: false
                        }
                    },

                    data: SeriesData
                },
                ,
                {
                    name: '当前不良率占比',
                    type: 'pie',
                    radius: ['20%', '25%'],
                   
                    label: {
                        normal: {
                            formatter: '{b}\n{d}%'
                        },

                    },
                    data: SeriesData
                }
            ]
        };

        var myChart = echarts.init(document.getElementById(divname));
        myChart.setOption(option);
    }
    function setQualifiedRate() {
        var XData = new Array();
        var Y1 = new Array();
        var Y2 = new Array();
        var Y3 = new Array();
        $.ajax({
            type: "post",
            url: "/SDMKanban/getQualifiedRate",
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                Jdata = JSON.parse(data);
                //console.log(Jdata);
                for (var i = 0; i < Jdata.length; i++) {
                    XData.push(Jdata[i].yd_dd);
                    Y1.push(Jdata[i].disarate);
                    Y2.push(Jdata[i].kwrate);
                    Y3.push(Jdata[i].kxrate);
                    

                }

            }

        });

        option = {
            title: {
                text: '产线合格率',
                textStyle: {
                    color: '#ffffff'
                }
            },
            tooltip: {
                trigger: 'axis',
                //axisPointer: {
                //    type: 'cross',
                //    //label: {
                //    //    backgroundColor: '#6a7985'
                //    //}
                //}
                formatter: function (params) {
                    return params[0].name + "<br>" +
                        params[0].seriesName + ":" + params[0].data + "%," +
                        params[1].seriesName + ":" + params[1].data + "%," +

                        params[2].seriesName + ":" + params[2].data + "%" + ""
                        ;
                }
            },
            legend: {
                data: ['垂直线', '水平线', '壳型线'],
                right: '0%',
                textStyle: {
                    color: '#ffffff'
                },
            },
            //toolbox: {
            //    feature: {
            //        saveAsImage: {}
            //    }
            //},
            grid: {
                left: '2%',
                right: '0%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: [
                {
                    type: 'category',
                    //boundaryGap: false,
                    axisLine: {
                        lineStyle: {
                            color: '#ffffff',
                        }

                    },
                    //  改变轴字体颜色和大小
                    axisLabel: {
                        type: 'value',
                        textStyle: {
                            color: '#ffffff',
                        },
                    },
                    data: XData
                }
            ],
            yAxis: [
                {
                    name: '合格率',
                    type: 'value',
                    axisLabel: {
                        formatter: '{value}%'
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#B0C4DE'
                        }
                    },
                    min: 80,
                    max: 100,
                }
                
            ],
            series: [
                {
                    name: '垂直线',
                    type: 'line',
                    
                    //areaStyle: {},
                    data: Y1,
                    color:'#5793f3'
                    //itemStyle: { normal: { label: { show: true, position: 'bottom', color: '#ffffff', rotate: true } } },
                },
                {
                    name: '水平线',
                    type: 'line',
                    
                    //areaStyle: {},
                    data: Y2,
                    color: '#00BFFF'
                    
                },
                {
                    name: '壳型线',
                    type: 'line',
                    color: '#B0C4DE',
                    
                    //areaStyle: {},
                    data: Y3
                   
                }
            ]
        };

        var myChart = echarts.init(document.getElementById("QuaifiedRate"));
        myChart.setOption(option);


        //var myChart = echarts.init(document.getElementById("myChart"));
        //myChart.setOption(option);

        var index = 0; //播放所在下标
        var mTime = setInterval(function () {
            myChart.dispatchAction({
                type: 'showTip',
                seriesIndex: 0,
                dataIndex: index
            });
            index++;
            if (index > Y1.length) {
                index = 0;
            }
        }, 1000);

    }

    //每日数据，做成一个柱状图
    function SetDayData()
    {
        var Jdata;
        var Xdata = new Array();
        var Y1 = new Array();
        var Y2 = new Array();
        var Y3 = new Array();
        var Y4 = new Array();
        var Y5 = new Array();
        $.ajax({
            type: "post",
            url: "/SDMKanban/GetCurrentDayData",
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                Jdata = JSON.parse(data);
                for (var i = 0; i < Jdata.length; i++)
                {
                    Xdata.push(Jdata[i].pdline);
                    Y1.push(Jdata[i].jh_qty);
                    Y2.push(Jdata[i].sj_qty);
                    Y3.push(Jdata[i].dun_qty);
                    Y4.push(Jdata[i].lu_qty);
                    Y5.push(Jdata[i].rate);
                }
            }
        });
        //console.log(Xdata);

        var colors = ['#5793f3', '#00BFFF', '#675bba','#B0C4DE'];

        option = {
            title: {
                text: '日产量',
                textStyle: {
                    color: '#ffffff'
                },
            },
            color: colors,

            tooltip: {
                //show: false,
                trigger: 'axis',
                //axisPointer: {
                //    type: 'cross'
                //},
                formatter: function (params) {
                    return params[0].name + "<br>" +
                        params[0].seriesName + ":" + params[0].data + "<br>" +
                        params[1].seriesName + ":" + params[1].data + "<br>" +

                        params[2].seriesName + ":" + params[2].data + "%"+"<br>"
                        ;
                }
            },
            grid: {
                //right: '20%',
                left: '16%',
                bottom:'12%'
            },
            toolbox: {
                //feature: {
                //    dataView: { show: true, readOnly: false },
                //    restore: { show: true },
                //    saveAsImage: { show: true }
                //}
            },
            legend: {
                data: ['计划数量', '生产箱数', '计划完成率'],
                //x: '20%',
                right:'10%',
                textStyle: {
                    color: '#ffffff'
                },
            },
            xAxis: [
                {
                    type: 'category',
                    axisLine: {
                        lineStyle: {
                            color: '#ffffff',
                        }

                    },
                    //  改变轴字体颜色和大小
                    axisLabel: {
                        textStyle: {
                            color: '#ffffff',
                        },
                    },
                    data: Xdata
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    name: '计划数量',
                    position: 'left',
                    
                    axisLine: {
                        lineStyle: {
                            color: colors[0]
                        }
                    }
                    //axisLabel: {
                    //    formatter: '{value} ml'
                    //}
                },
                {
                    type: 'value',
                    name: '计划完成率',

                    position: 'right',
                    //offset: 60,
                    axisLine: {
                        lineStyle: {
                            color: '#7B68EE'
                        }
                    },
                     axisLabel: {
                        formatter: '{value} %'
                    }

                }
                
            ],
            series: [
                {
                    name: '计划箱数',
                    type: 'bar',
                    barWidth: 30,
                    data: Y1,
                    color: colors[0],
                    itemStyle: {
                        normal: { label: { show: true, position: 'top', color: '#ffffff' },barBorderRadius: [100, 100, 100, 100] },
                        
                    }
                },
                {
                    name: '生产箱数',
                    type: 'bar',
                    barWidth: 30,
                    //yAxisIndex: 1,
                    data: Y2,
                    color: colors[1],
                    itemStyle: {
                        normal: { label: { show: true, position: 'top', color: '#ffffff' }, barBorderRadius: [100, 100, 100, 100] },
                        
                    }
                },
                //{
                //    name: '生产吨数',
                //    type: 'bar',
                //    yAxisIndex: 2,
                //    data: Y3,
                //    itemStyle: { normal: { label: { show: true, position: 'top', color: '#ffffff' } } }
                //},
                //{
                //    name: '炉数',
                //    type: 'bar',
                //    yAxisIndex: 3,
                //    data: Y4,
                //    itemStyle: { normal: { label: { show: true, position: 'top', color: '#ffffff' } } }
                //},
                {
                    name: '计划完成率',
                    type: 'line',
                    yAxisIndex: 1,
                    data: Y5,
                    color: '#7B68EE',
                    itemStyle: { normal: { label: { show: true, color: '#7B68EE', formatter: '{c}%' } } }
                }
            ]
        };

        var myChart = echarts.init(document.getElementById('DayData'));
        myChart.setOption(option);
    }

    function SetPourRate()
    {
        var Jdata;
        var Xdata = new Array();
        var Y1 = new Array();
        var Y2 = new Array();
        var Y3 = new Array();
        $.ajax({
            type: "post",
            url: "/SDMKanban/GetPouringOKRate",
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                Jdata = JSON.parse(data);
                for (var i = 0; i < Jdata.length; i++) {
                    Xdata.push(Jdata[i].pdline);
                    Y1.push(Jdata[i].pouringqty);
                    Y2.push(Jdata[i].boxqty);
                    Y3.push(Jdata[i].rate*100);
                }
            }
        });
        //console.log(Xdata);

        var colors = ['#5793f3', '#00BFFF', '#675bba'];

        option = {
            title: {
                text: '当月浇注合格率',
                textStyle: {
                    color: '#ffffff'
                },
            },
            color: colors,

            tooltip: {
                trigger: 'axis',
                //axisPointer: {
                //    type: 'cross'
                //},
                formatter: function (params) {
                    return params[0].name + "<br>" +
                        params[0].seriesName + ":" + params[0].data + "<br>" +
                        params[1].seriesName + ":" + params[1].data + "<br>" +
                        params[2].seriesName + ":" + params[2].data + "%" +"<br>"
                        ;
                }
            },
            grid: {
                left:'12%',
                bottom: '12%'
            },
            toolbox: {
                //feature: {
                //    dataView: { show: true, readOnly: false },
                //    restore: { show: true },
                //    saveAsImage: { show: true }
                //}
            },
            legend: {
                data: ['浇注数', '装箱数', '合格率'],
                right: '0%',
                textStyle: {
                    color: '#ffffff'
                },
            },
            xAxis: [
                {
                    type: 'category',
                    axisTick: {
                        alignWithLabel: true
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#ffffff',
                        }

                    },
                    //  改变轴字体颜色和大小
                    axisLabel: {
                        textStyle: {
                            color: '#ffffff',
                        },
                    },
                    data: Xdata
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    name: '浇注数/装箱数',
                    position: 'left',
                    axisLine: {
                        lineStyle: {
                            color: colors[0]
                        }
                    }
                },
                {
                    type: 'value',
                    name: '合格率',
                    position: 'right',
                    
                    axisLine: {
                        lineStyle: {
                            color: "#7B68EE"
                        }
                    },
                    axisLabel: {
                        formatter: '{value}%'
                    }

                }

            ],
            series: [
                {
                    name: '浇注数',
                    type: 'bar',
                    data: Y1,
                    barWidth: 30,
                    itemStyle: { normal: { label: { show: true, position: 'top', color: '#ffffff' }, barBorderRadius: [100, 100, 100, 100] } },
                },
                {
                    name: '装箱数',
                    type: 'bar',
                    barWidth: 30,
                    //yAxisIndex: 1,
                    data: Y2,
                    itemStyle: { normal: { label: { show: true, position: 'top', color: '#ffffff' }, barBorderRadius: [100, 100, 100, 100] } },
                },
                {
                    name: '合格率',
                    type: 'line',
                    yAxisIndex: 1,
                    data: Y3,
                    itemStyle: { normal: { color: "#7B68EE", label: { show: true, color: 'auto', formatter: '{c}%' } } },

                    tooltip: { formatter: '{c1}%' }
                }
            ]
        };

        var myChart = echarts.init(document.getElementById('PourRate'));
        myChart.setOption(option);
    }

    function SetEquipMainData(YWBType,divname) {
        var Xdata = new Array();
        var Y1 = new Array();
        var Y2 = new Array();
        var Y3 = new Array();
        $.ajax({
            type: "post",
            url: "/SDMKanban/getEquipmentYWBResult",
            data: { YWBType: YWBType},
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                Jdata = JSON.parse(data);
                
                for (var i = 0; i < Jdata.length; i++) {
                    Xdata.push(Jdata[i].pdline);
                    Y1.push(Jdata[i].allcount);
                    Y2.push(Jdata[i].tcount);
                    Y3.push(Jdata[i].rate);
                }
            }
        });

        var Title = "";
        if (YWBType == "SBXJGD") { Title = "设备巡检完成情况"; }
        else if (YWBType == "SBBYGD") { Title = "设备保养完成情况"; }
        else if (YWBType == "SBDJGD") { Title = "设备点检完成情况"; }

        option = {
            title: {
                text: Title,
                textStyle: {
                    color: '#ffffff'
                },
            },
            tooltip: {
                trigger: 'axis',
                //axisPointer: {
                //    type: 'cross',
                //    crossStyle: {
                //        color: '#999'
                //    }
                //}
            },
            toolbox: {
                //feature: {
                //    dataView: { show: false, readOnly: false },
                //    magicType: { show: true, type: ['line', 'bar'] },
                //    restore: { show: true },
                //    saveAsImage: { show: true }
                //}
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                
                containLabel: true
            },
            legend: {
                data: ['计划数量', '完成数量', '完成率'],
                right: '0%',
                //top:'10%',
                textStyle: {
                    color: '#ffffff'
                },
            },
            xAxis: [
                {
                    type: 'category',
                    data: Xdata,
                    axisPointer: {
                        type: 'shadow'
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#ffffff',
                        }

                    },
                    //  改变轴字体颜色和大小
                    axisLabel: {
                        textStyle: {
                            color: '#ffffff',
                        },
                    },
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    name: '数量',
                    min: 0,
                    axisLine: {
                        lineStyle: {
                            color: '#B0C4DE'
                        }
                    }
                    //,
                    //max: $scope.max[0],
                    //interval: $scope.min[0]

                },
                {
                    type: 'value',
                    name: '完成率',
                    min: 0,
                    max: 100,
                    interval: 10,
                    axisLabel: {
                        formatter: '{value} %'
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#7B68EE'
                        }
                    }
                }
            ],
            series: [
                {
                    name: '计划数量',
                    type: 'pictorialBar',
                    symbol: 'path://d="M150 0 L75 200 L225 200 Z"',
                    data: Y1,
                    color: '#5793f3',
                    itemStyle: { normal: { label: { show: true, position: 'top', color: '#ffffff' } } }
                },
                {
                    name: '完成数量',
                    type: 'pictorialBar',
                    symbol: 'path://d="M150 0 L75 200 L225 200 Z"',
                    data: Y2,
                    color: '#00BFFF',
                    itemStyle: { normal: { label: { show: true, position: 'top', color: '#ffffff' } } }
                },
                {
                    name: '完成率',
                    type: 'line',
                    yAxisIndex: 1,
                    data: Y3,
                    color: '#7B68EE',
                    itemStyle: { normal: { label: { show: true, position: 'right', color: '#ffffff', formatter: '{c}%' } } }
                }
            ]
        };

        var myChart = echarts.init(document.getElementById(divname));
        myChart.setOption(option);
    }

    function SetOnePassData() {
        var X1 = new Array();
        var X2 = new Array();
        var X3 = new Array();

        var Y1 = new Array();
        var Y2 = new Array();
        var Y3 = new Array();
        $.ajax({
            type: "post",
            url: "/SDMKanban/getZCPASSrate",
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                Jdata = JSON.parse(data);
               
                for (var i = 0; i < Jdata.length; i++) {
                    if (Jdata[i].pdline == "水平线") {
                        X1.push(Jdata[i].zc_name);
                        Y1.push(Jdata[i].passrate * 100);
                    }
                    else if (Jdata[i].pdline == "垂直线") {
                        X2.push(Jdata[i].zc_name);
                        Y2.push(Jdata[i].passrate * 100);
                    }
                    else if (Jdata[i].pdline == "壳型线") {
                        X3.push(Jdata[i].zc_name);
                        Y3.push(Jdata[i].passrate * 100);
                    }
                }

            }
        });
        //console.log(X1);
        //console.log(Y1);
        option1 = {
            title: {
                text: '水平线工序一次完成率',
                textStyle: {
                    color: '#ffffff'
                },
            },
            color: ['#3398DB'],
            tooltip: {
                trigger: 'axis',
                //axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                //    type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                //}
            },
            grid: {
                left: '9%',
                right: '8%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: [
                {
                    type: 'category',
                    data: X1,
                    axisTick: {
                        alignWithLabel: true
                    },
                    boundaryGap: false,
                    axisLine: {
                        lineStyle: {
                            color: '#ffffff',
                        }

                    },
                    //  改变轴字体颜色和大小
                    axisLabel: {
                        textStyle: {
                            color: '#ffffff',
                        },
                    },
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    axisLabel: {
                        formatter: '{value} %'
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#B0C4DE'
                        }
                    }
                }
                
            ],
            series: [
                {
                    //name: '水平线工序一次完成率',
                    type: 'line',
                    barWidth: '60%',
                    data: Y1,
                    itemStyle: { normal: { label: { show: true, position: 'top', color: '#ffffff', formatter: '{c}%' }, areaStyle: { type: 'default' } } }
                }
            ]
        };
        
        option2 = {
            title: {
                text: '垂直线工序一次完成率',
                textStyle: {
                    color: '#ffffff'
                },
            },
            color: ['#3398DB'],
            tooltip: {
                trigger: 'axis',
                axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                    type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                }
            },
            grid: {
                left: '9%',
                right: '8%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: [
                {
                    type: 'category',
                    data: X2,
                    boundaryGap: false,
                    axisTick: {
                        alignWithLabel: true
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#ffffff',
                        }

                    },
                    //  改变轴字体颜色和大小
                    axisLabel: {
                        textStyle: {
                            color: '#ffffff',
                        },
                    },
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    axisLabel: {
                        formatter: '{value} %'
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#B0C4DE'
                        }
                    }
                }
            ],
            series: [
                {
                    //name: '水平线工序一次完成率',
                    type: 'line',
                    barWidth: '60%',
                    data: Y2,
                    itemStyle: { normal: { label: { show: true, position: 'top', color: '#ffffff', formatter: '{c}%' }, areaStyle: { type: 'default' } } }
                }
            ]
        };

        option3 = {
            title: {
                text: '壳型线工序一次完成率',
                textStyle: {
                    color: '#ffffff'
                },
            },
            color: ['#3398DB'],
            tooltip: {
                trigger: 'axis',
                //axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                //    type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                //}
            },
            grid: {
                left: '9%',
                right: '8%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: [
                {
                    type: 'category',
                    data: X3,
                    boundaryGap: false,
                    axisTick: {
                        alignWithLabel: true
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#ffffff',
                        }

                    },
                    axisLabel: {
                        textStyle: {
                            color: '#ffffff',
                        },
                    },
                }
                
                //  改变轴字体颜色和大小
                
            ],
            yAxis: [
                {
                    type: 'value',
                    axisLabel: {
                        formatter: '{value} %'
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#B0C4DE'
                        }
                    }
                },    
            ],
            series: [
                {
                    //name: '水平线工序一次完成率',
                    type: 'line',
                    barWidth: '60%',
                    data: Y3,
                    itemStyle: { normal: { label: { show: true, position: 'top', color: '#ffffff', formatter: '{c}%' }, areaStyle: { type: 'default' } } }
                }
            ]
        };


        var myChart = echarts.init(document.getElementById('SPONEPASS'));
        myChart.setOption(option1);
        

        var myChart2 = echarts.init(document.getElementById('DISAONEPASS'));
        myChart2.setOption(option2);

        var myChart3 = echarts.init(document.getElementById('KXONEPASS'));
        myChart3.setOption(option3);
    }

    function SetTodayStopTime() {
        var Xdata = new Array();
        var Ydata = new Array();

        $.ajax({
            type: "post",
            url: "/SDMKanban/getPDLINESTOPTIME",
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                Jdata = JSON.parse(data);
                //Templegend.push(Jdata[0].dev_name);
                for (var i = 0; i < Jdata.length; i++) {
                    Xdata.push(Jdata[i].pdline);
                    Ydata.push(Jdata[i].stoptime);
                }
            }
        });

        option = {
            title: {
                text: '今日停机时长',
                textStyle: {
                    color: '#ffffff'
                },
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },
            legend: {
                data: ['停机时长'],
                textStyle: {
                    color: '#ffffff'
                },
                right: '0%',
            },
            grid: {
                left: '3%',
                right: '6%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                splitLine: { show: false },//去除网格线
                type: 'value',
                boundaryGap: [0, 0.01],
                axisLine: {
                    lineStyle: {
                        color: '#ffffff',
                    }

                },
                //  改变轴字体颜色和大小
                axisLabel: {
                    textStyle: {
                        color: '#ffffff',
                        formatter: '{value}min'
                    },
                },
            },
            yAxis: {
                type: 'category',
                data: Xdata,
                axisLine: {
                    lineStyle: {
                        color: '#B0C4DE'
                    }
                },
                splitLine: { show: false },//去除网格线
                //axisLabel: {
                //    color: '#B0C4DE',
                //    formatter: '{value}min'
                //}
            },
            series: [
                {
                    name: '停机时长',
                    type: 'pictorialBar',
                    symbol: 'rect',
                    "symbolRepeat": true, // "fixed",
                    "symbolMargin": "5%",
                    "symbolClip": true,
                    "symbolSize": 22.5,
                    // "symbolPosition": "start",
                    //"symbolOffset": [
                    //    20,
                    //    0],
                    data: Ydata,
                    color:'#5793f3',
                    itemStyle: { normal: { label: { show: true, position: 'inside', color: '#ffffff', formatter: '{c} min' } } }
                }
            ]
        };
        var myChart = echarts.init(document.getElementById('TodayStopTime'));
        myChart.setOption(option);
    }

    var HJMlist = new Array();
    function GetHJMList() {
        $.ajax({
            type: "post",
            url: "/SDMKanban/getHJMList",
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                Jdata = JSON.parse(data);
                for (var i = 0; i < Jdata.length; i++) {
                    HJMlist.push(Jdata[i].dev_id);
                }
            }
        });
    }
    function SetHJMData() {

        option = {
            title: {
                text: '车间环境监控',
                textStyle: {
                    color: '#ffffff'
                },
            },
            tooltip: {
                trigger: 'axis',
                //axisPointer: {
                //    type: 'cross',
                //    crossStyle: {
                //        color: '#999'
                //    }
                //}
            },
            grid: {
                left: '10%',
                right: '1%',
                bottom: '3%',

                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: [],
                //axisLine: {
                //    lineStyle: {
                //        color: '#ffffff',
                //    }

                //},
                ////  改变轴字体颜色和大小
                //axisLabel: {
                //    textStyle: {
                //        color: '#ffffff',
                //    },
                //},
            },
            legend: {
                data: ['湿度', '温度'],
                textStyle: {
                    color: '#ffffff'
                },
                right: '0%',
            },
            yAxis: [{
                type: 'value',
                name: '湿度',
                //min: 'dataMin',
                offset: 0,
                position: 'left',
                axisLabel: {
                    formatter: '{value} %'
                },
                axisLine: {
                    lineStyle: {
                        color: '#B0C4DE'
                    }
                }

            },
            {
                type: 'value',
                name: '温度',
                position: 'right',
                    //min: 'dataMin',
                axisLabel: {
                     formatter: '{value} ℃'
                },
                axisLine: {
                    lineStyle: {
                        color: '#B0C4DE'
                    }
                }
            }
            ],
            series: [{
                data: [],
                type: 'line'
            }]
        };
        var myChart = echarts.init(document.getElementById('HJMData'));
        myChart.setOption(option, true);
        //console.log(HJMlist);
        //设置轮播，每隔5秒换一个环境猫设备
        var index = 0; //播放所在下标

        var TempSeries = new Array();
        var SeriesObject = new Object();

        var SeriesObjectData = new Array();
        var SeriesObjectT = new Object();
        var SeriesObjectDataT = new Array();
        var xAxisObject = new Object();
        var xAxisObjectData = new Array();

        var Templegend = new Array();

        var Temptitle = new Object();


        var ColorObject = new Object();

        var lineStyle = new Object();
        var textStyle = new Object();

        $.ajax({
            type: "post",
            url: "/SDMKanban/getHJMData",
            data: { HJMID: HJMlist[index] },
            async: false,
            success: function (data) {
                if (data == "") {
                    return false;
                }
                Jdata = JSON.parse(data);
                //Templegend.push(Jdata[0].dev_name);
                for (var i = 0; i < Jdata.length; i++) {
                    xAxisObjectData.push(Jdata[i].newtime)
                    SeriesObjectData.push(Jdata[i].h);
                    SeriesObjectDataT.push(Jdata[i].t);
                }

                Temptitle.text = '车间环境-'+Jdata[0].dev_name;
                ColorObject.color = "#fff";
                Temptitle.textStyle = ColorObject;
                lineStyle.color = "#FFFFFF";
                textStyle.color = "#FFFFFF";

                
                xAxisObject.type = 'category';
                xAxisObject.data = xAxisObjectData;
                xAxisObject.axisLine = new Object();
                xAxisObject.axisLine.lineStyle = lineStyle;
                xAxisObject.axisLabel = textStyle;

                SeriesObject.name = '湿度';
                SeriesObject.type = 'line';
                SeriesObject.color = '#5a9ddd';
                SeriesObject.data = SeriesObjectData;

                SeriesObjectT.name = '温度';
                SeriesObjectT.yAxisIndex = 1;
                SeriesObjectT.color = '#00BFFF';
                SeriesObjectT.type = 'line';
                SeriesObjectT.data = SeriesObjectDataT;

                TempSeries.push(SeriesObject);
                TempSeries.push(SeriesObjectT);


                option.title = Temptitle;
                option.xAxis = xAxisObject;
                //option.legend = ["环境猫"];
                option.series = TempSeries;
                //console.log(option);
                myChart.setOption(option, true);
            }
        });


        index++;
        if (index > HJMlist.length) {
            index = 0;
        }

        var mTime = setInterval(function () {
            var TempSeries = new Array();
            var SeriesObject = new Object();

            var SeriesObjectData = new Array();
            var SeriesObjectT = new Object();
            var SeriesObjectDataT = new Array();
            var xAxisObject = new Object();
            var xAxisObjectData = new Array();

            var Templegend = new Array();

            var Temptitle = new Object();

            var ColorObject = new Object();

            var lineStyle = new Object();
            var textStyle = new Object();

            $.ajax({
                type: "post",
                url: "/SDMKanban/getHJMData",
                data: { HJMID: HJMlist[index]},
                async: false,
                success: function (data) {
                    if (data == "") {
                        return false;
                    }
                    Jdata = JSON.parse(data);
                    //Templegend.push(Jdata[0].dev_name);
                    for (var i = 0; i < Jdata.length; i++) {
                        xAxisObjectData.push(Jdata[i].newtime)
                        SeriesObjectData.push(Jdata[i].h);
                        SeriesObjectDataT.push(Jdata[i].t);
                    }
                    ColorObject.color = "#fff";
                    Temptitle.text = '车间环境-'+Jdata[0].dev_name;
                    Temptitle.textStyle = ColorObject;

                    lineStyle.color = "#FFFFFF";
                    textStyle.color = "#FFFFFF";

                    
                    xAxisObject.type = 'category';
                    xAxisObject.data = xAxisObjectData;
                    xAxisObject.axisLine = new Object();
                    xAxisObject.axisLine.lineStyle = lineStyle;
                    
                    xAxisObject.axisLabel = textStyle;

                    SeriesObject.name = '湿度';
                    SeriesObject.type = 'line';
                    SeriesObject.color = '#5a9ddd';
                    SeriesObject.data = SeriesObjectData;

                    SeriesObjectT.name = '温度';
                    SeriesObjectT.yAxisIndex = 1;
                    SeriesObjectT.color = '#00BFFF';
                    SeriesObjectT.type = 'line';
                    SeriesObjectT.data = SeriesObjectDataT;

                    TempSeries.push(SeriesObject);
                    TempSeries.push(SeriesObjectT);


                    option.title = Temptitle;
                    option.xAxis = xAxisObject;
                    //option.legend = ["环境猫"];
                    option.series = TempSeries;
                    
                    myChart.setOption(option, true);
                }
            });


            index++;
            if (index > HJMlist.length) {
                index = 0;
            }
        }, 5000);

    }



    //定时获取当前时间
    function ServerCurrentTime() {
        var now = new Date();
        var year = now.getFullYear();
        var month = now.getMonth();
        var date = now.getDate();
        var day = now.getDay();
        var hour = now.getHours();
        var minu = now.getMinutes();
        var sec = now.getSeconds();
        var week;
        month = month + 1;
        if (month < 10) month = "0" + month;
        if (date < 10) date = "0" + date;
        if (hour < 10) hour = "0" + hour;
        if (minu < 10) minu = "0" + minu;
        if (sec < 10) sec = "0" + sec;
        var arr_week = new Array("星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六");
        week = arr_week[day];
        var time = "";
        time = year + "年" + month + "月" + date + "日" + " " + hour + ":" + minu + ":" + sec;
        $("#CurrentTime").text(time);
        var timer = setTimeout("ServerCurrentTime()", 1000);
    }


    //全屏代码
    (function ($) {

        // Adding a new test to the jQuery support object
        $.support.fullscreen = supportFullScreen();

        // Creating the plugin
        $.fn.fullScreen = function (props) {

            if (!$.support.fullscreen || this.length != 1) {

                // The plugin can be called only
                // on one element at a time

                return this;
            }

            if (fullScreenStatus()) {
                // if we are already in fullscreen, exit
                cancelFullScreen();
                return this;
            }

            // You can potentially pas two arguments a color
            // for the background and a callback function

            var options = $.extend({
                'background': '#111',
                'callback': function () { }
            }, props);

            // This temporary div is the element that is
            // actually going to be enlarged in full screen

            var fs = $('<div>', {
                'css': {
                    'overflow-y': 'auto',
                    'background': options.background,
                    'width': '100%',
                    'height': '100%',
                    'align': 'center'
                }
            });

            var elem = this;

            // You can use the .fullScreen class to
            // apply styling to your element
            elem.addClass('fullScreen');

            // Inserting our element in the temporary
            // div, after which we zoom it in fullscreen
            fs.insertBefore(elem);
            fs.append(elem);
            requestFullScreen(fs.get(0));

            fs.click(function (e) {
                if (e.target == this) {
                    // If the black bar was clicked
                    cancelFullScreen();
                }
            });

            elem.cancel = function () {
                cancelFullScreen();
                return elem;
            };

            onFullScreenEvent(function (fullScreen) {

                if (!fullScreen) {

                    // We have exited full screen.
                    // Remove the class and destroy
                    // the temporary div

                    elem.removeClass('fullScreen').insertBefore(fs);
                    fs.remove();
                }

                // Calling the user supplied callback
                options.callback(fullScreen);
            });

            return elem;
        };


        // These helper functions available only to our plugin scope.


        function supportFullScreen() {
            var doc = document.documentElement;

            return ('requestFullscreen' in doc) ||
                ('mozRequestFullScreen' in doc && document.mozFullScreenEnabled) ||
                ('webkitRequestFullScreen' in doc);
        }

        function requestFullScreen(elem) {
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.mozRequestFullScreen) {
                elem.mozRequestFullScreen();
            } else if (elem.webkitRequestFullScreen) {
                elem.webkitRequestFullScreen();
            }
        }

        function fullScreenStatus() {
            return document.fullscreen ||
                document.mozFullScreen ||
                document.webkitIsFullScreen;
        }

        function cancelFullScreen() {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.mozCancelFullScreen) {
                document.mozCancelFullScreen();
            } else if (document.webkitCancelFullScreen) {
                document.webkitCancelFullScreen();
            }
        }

        function onFullScreenEvent(callback) {
            $(document).on("fullscreenchange mozfullscreenchange webkitfullscreenchange", function () {
                // The full screen status is automatically
                // passed to our callback as an argument.
                callback(fullScreenStatus());
            });
        }

    })(jQuery);
    


    
</script>
